= render "modules/navbar"

.SearchPage
  .SearchPage__left

    %a.SearchModal__btn{href: ""} 評価する
    .SearchModal.js-modal
      .SearchModal__background.SearchModal__close
      .SearchModal__content

        .Search__contents
          = search_form_for @search, url: search_path do |f|
            = f.text_field :price_gteq, class: "form-control"
            = f.text_field :price_lteq, class: "form-control"

            = text_field_tag :start_date, params[:start_date], readonly: true, placeholder: "チェックイン", class: "SearchForm__checkin form-control", id: "search_checkin"
            = text_field_tag :end_date, params[:end_date], readonly: true,  placeholder: "チェックアウト", class: "SearchForm__checkout form-control", id: "search_checkout"

            = check_box_tag "q[room_type_eq_any][]", "個室"
            %p 個室
            = check_box_tag "q[room_type_eq_any][]", "シェアルーム"
            %p シェアルーム
            = check_box_tag "q[room_type_eq_any][]", "貸し切り"
            %p 貸し切り

            = f.label :member, class: "RoomNewForm__label"
            = f.select :member_gteq, [["1名", 1], ["2名", 2], ["3名", 3], ["4名以上", 4]], include_blank: "選択して下さい"

            = f.label :bed, class: "RoomNewForm__label"
            = f.select :bed_gteq, [["1つ", 1], ["2つ", 2], ["3つ", 3], ["4つ以上", 4]], include_blank: "選択して下さい"

            = f.label :bath, class: "RoomNewForm__label"
            = f.select :bath_gteq, [["1つ", 1], ["2つ", 2], ["3つ", 3], ["4つ以上", 4]], include_blank: "選択して下さい"

            = check_box_tag "q[is_tv_eq]", true
            %p TV

            = check_box_tag "q[is_kitchen_eq]", true
            %p キッチン

            = check_box_tag "q[is_wifi_eq]", true
            %p Wifi

            = check_box_tag "q[is_heater_eq]", true
            %p 暖房

            = check_box_tag "q[is_air_eq]", true
            %p エアコン

            = f.submit "検索"


        %a.SearchModal__close{href: ""} 閉じる 

    = render 'search_results', rooms: @arrRooms
    
  .SearchPage__right
    #map{ data: { turbolinks: false } }

:javascript
  $(function(){
    $('.SearchModal__btn').on('click',function(){
        $('.js-modal').fadeIn();
        return false;
    });
    $('.SearchModal__close').on('click',function(){
        $('.js-modal').fadeOut();
        return false;
    });
  });

  function initMap(){
    let geocoder = new google.maps.Geocoder()

    let location = {lat: 35.2738, lng: 137.007}
    
    if("#{@arrRooms}".length > 0) {
      location = {lat: #{@arrRooms[0].latitude}, lng: #{@arrRooms[0].longitude}}
    }
    
     map = new google.maps.Map(document.getElementById('map'), {
      center: location,
      zoom: 11
    });

    $.each("#{@arrRooms}", function(room){
      markerLatLng = new google.maps.LatLng({
        lat: room.latitude,
        lng: room.longitude
      });
      
      let marker = new google.maps.Marker({
        position: markerLatLng,
        map: map
      });
    })
    
  }